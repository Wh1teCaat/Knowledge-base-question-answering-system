syntax = "proto3";

option go_package = "github.com/Wh1teCaat/multi-agent/proto";

// 用户认证
service UserService {
    rpc Register (RegisterReq) returns (RegisterResp);
    rpc Login (LoginReq) returns (LoginResp);
    rpc RefreshToken (RefreshTokenReq) returns (LoginResp);
}

// 代理对话
service AgentService {
    rpc Chat (stream ChatReq) returns (stream ChatResp);
}

message RegisterReq {
    string username = 1;
    string password = 2;
    string email = 3;
}

message RegisterResp {
    string username = 1;
}

message LoginReq {
    string username = 1;
    string password = 2;
}

message LoginResp {
    string access_token = 1;    // 短期 token
    string refresh_token = 2;   // 长期 token
    int64 expires_at = 3;   // 过期时间
}

message RefreshTokenReq {
    string refresh_token = 1;
}

message ChatReq {
    uint32 id = 1;
    string thread_id = 2;
    string query = 3;
}

message ChatResp {
    string response = 1;
}